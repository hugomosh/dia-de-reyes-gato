<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>El gato y los reyes magos</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>üëë</text></svg>" />
    <style>
      body {
        font-family: 'Source Code Pro', monospace;
        background-color: #0d1635;
        color: #f3d854;
        text-shadow: 0 0 2px #f3d854;
      }

      p {
        color: aliceblue;
        text-shadow: none;
      }

      #all-states {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
        grid-auto-rows: 1fr;
        aspect-ratio: 1;
        gap: 20px;
        padding: 20px;
        font-size: 8px;
      }

      .state {
        padding: 8px;
        border-radius: 8px;
        background-color: #1a2540;
        width: fit-content;
        aspect-ratio: 1;
        display: block;
        white-space: pre;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }

      /* Unclaimed states - gray and dimmed */
      .state.unclaimed {
        opacity: 0.3;
        filter: grayscale(100%);
      }

      /* Claimed states - bright and colorful */
      .state.claimed {
        opacity: 1;
        filter: grayscale(0%);
        animation: glow-pulse 2s ease-in-out infinite;
      }

      @keyframes glow-pulse {
        0%, 100% {
          filter: brightness(1);
        }
        50% {
          filter: brightness(1.2);
        }
      }

      .state-terminal .grid {
        text-shadow:
          0 0 5px #f3d854,
          0 0 10px #f3d854;
      }

      .mark-x {
        color: #ff4c4c;
        text-shadow: 0 0 2px #ff4c4c;
      }

      .mark-o {
        color: #4c9aff;
        text-shadow: 0 0 2px #4c9aff;
      }

      .mark-winning {
        font-weight: bold;
      }

      .mark-winning.mark-x {
        text-shadow:
          0 0 5px #ff4c4c,
          0 0 10px #ff4c4c,
          0 0 15px #ff4c4c;
      }

      .mark-winning.mark-o {
        text-shadow:
          0 0 5px #4c9aff,
          0 0 10px #4c9aff,
          0 0 15px #4c9aff;
      }

      button {
        margin-top: 20px;
        padding: 10px 20px;
        font-size: 16px;
        background-color: #f3d854;
        color: #0d1635;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        box-shadow:
          #f3d854 0 0 5px,
          #f3d854 0 0 10px;
      }

      .text-content {
        text-align: center;
        margin: 20px;
        max-width: 800px;
        margin: auto;
      }

      .stats {
        font-size: 14px;
        color: #4c9aff;
        margin-top: 10px;
      }

      /* Modal Styles */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1000;
      }

      .modal.active {
        display: block;
      }

      .modal-backdrop {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(13, 22, 53, 0.95);
        backdrop-filter: blur(4px);
        z-index: 1;
      }

      .modal-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #1a2540;
        border: 0px solid #f3d854;
        border-radius: 16px;
        padding: 40px 40px 60px 40px;
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        overflow-x: hidden;
        box-shadow: 0 0 7px rgba(243, 216, 84, 0.3);
        z-index: 2;
      }

      .modal-step {
        display: none;
      }

      .modal-step.active {
        display: block;
      }

      .modal h2 {
        color: #f3d854;
        text-align: center;
        margin-bottom: 20px;
        font-size: 24px;
      }

      .modal p {
        text-align: center;
        margin-bottom: 20px;
        color: #c0c0c0;
      }

      /* Initial Loading Overlay */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #0d1635;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.5s ease;
      }

      .loading-overlay.hidden {
        opacity: 0;
        pointer-events: none;
      }

      /* Loading Animation - Orbital Particles */
      .loading-orbital {
        text-align: center;
        padding: 40px;
      }

      .orbital-container {
        position: relative;
        width: 150px;
        height: 150px;
        margin: 0 auto 20px;
      }

      .orbit {
        position: absolute;
        border: 1px solid rgba(243, 216, 84, 0.2);
        border-radius: 50%;
        animation: rotate 3s linear infinite;
        top: 50%;
        left: 50%;
      }

      .orbit-1 {
        width: 60px;
        height: 60px;
        margin-left: -30px;
        margin-top: -30px;
      }

      .orbit-2 {
        width: 100px;
        height: 100px;
        margin-left: -50px;
        margin-top: -50px;
        animation-duration: 4s;
      }

      .orbit-3 {
        width: 140px;
        height: 140px;
        margin-left: -70px;
        margin-top: -70px;
        animation-duration: 5s;
      }

      .particle {
        position: absolute;
        width: 8px;
        height: 8px;
        background: #4c9aff;
        border-radius: 50%;
        box-shadow: 0 0 10px #4c9aff;
        top: 50%;
        left: 50%;
        margin-top: -4px;
        margin-left: -4px;
        transform: translateX(calc(var(--orbit-radius) / 2 - 4px));
      }

      .orbit-1 .particle {
        --orbit-radius: 60px;
      }

      .orbit-2 .particle {
        --orbit-radius: 100px;
      }

      .orbit-3 .particle {
        --orbit-radius: 140px;
      }

      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      /* State Options */
      .state-options {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-top: 30px;
      }

      .state-option {
        background: #0d1635;
        border: 2px solid #f3d854;
        border-radius: 12px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
        min-height: 180px;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .state-option.spinning {
        cursor: default;
        opacity: 0.7;
      }

      .state-option.stopped {
        animation: slot-stop 0.5s ease-out;
        border-color: #4c9aff;
        box-shadow: 0 0 15px rgba(76, 154, 255, 0.4);
      }

      .state-option:not(.spinning):not(.stopped):hover {
        transform: translateY(-3px);
        box-shadow: 0 3px 15px rgba(243, 216, 84, 0.3);
        border-color: #ff4c4c;
      }

      .state-option.selected {
        border-color: #4c9aff;
        box-shadow: 0 0 20px rgba(76, 154, 255, 0.6);
      }

      @keyframes slot-stop {
        0% {
          transform: scale(1.15);
          opacity: 0.7;
        }
        50% {
          transform: scale(0.95);
          opacity: 1;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .state-option .state-board {
        font-family: 'Source Code Pro', monospace;
        font-size: 12px;
        line-height: 1.2;
        margin-bottom: 15px;
        white-space: pre;
      }

      .state-option .state-info {
        font-size: 11px;
        color: #4c9aff;
        margin-top: 10px;
      }

      /* Form Styles */
      .form-group {
        margin-bottom: 20px;
        text-align: left;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #f3d854;
        font-size: 14px;
      }

      .form-group input {
        width: 100%;
        padding: 12px;
        background: #0d1635;
        border: 1px solid #f3d854;
        border-radius: 8px;
        color: #f3d854;
        font-family: 'Source Code Pro', monospace;
        font-size: 14px;
        box-sizing: border-box;
      }

      .form-group input:focus {
        outline: none;
        border-color: #4c9aff;
        box-shadow: 0 0 10px rgba(76, 154, 255, 0.3);
      }

      .form-note {
        font-size: 12px;
        color: #4c9aff;
        text-align: center;
        margin-top: 15px;
      }

      .claim-submit,
      .back-button,
      .modal-done,
      .retry-button {
        width: 100%;
        padding: 14px;
        margin-top: 10px;
        font-size: 15px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-family: 'Source Code Pro', monospace;
        transition: all 0.2s ease;
      }

      .claim-submit {
        background: #f3d854;
        color: #0d1635;
        font-weight: 500;
      }

      .claim-submit:hover {
        background: #fde68a;
        transform: translateY(-1px);
      }

      .back-button,
      .retry-button {
        background: transparent;
        color: #f3d854;
        border: 1px solid #f3d854;
      }

      .back-button:hover,
      .retry-button:hover {
        background: rgba(243, 216, 84, 0.1);
      }

      .modal-done {
        background: transparent;
        color: #c0c0c0;
        border: 1px solid #c0c0c0;
        font-weight: 400;
      }

      .modal-done:hover {
        background: rgba(192, 192, 192, 0.1);
        color: #e8e8e8;
        border-color: #e8e8e8;
      }

      /* Success Screen */
      #step-success {
        position: relative;
        overflow: hidden;
      }

      .success-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
      }

      .success-content {
        position: relative;
        z-index: 1;
      }

      /* Cosmic Sparkles - Background */
      .star {
        position: absolute;
        width: 3px;
        height: 3px;
        background: #f3d854;
        border-radius: 50%;
        box-shadow: 0 0 8px #f3d854;
        animation: twinkle 2s ease-in-out infinite;
      }

      .star:nth-child(1) { top: 10%; left: 15%; animation-delay: 0s; }
      .star:nth-child(2) { top: 20%; left: 85%; animation-delay: 0.3s; }
      .star:nth-child(3) { top: 35%; left: 10%; animation-delay: 0.6s; }
      .star:nth-child(4) { top: 45%; left: 90%; animation-delay: 0.9s; }
      .star:nth-child(5) { top: 60%; left: 20%; animation-delay: 1.2s; }
      .star:nth-child(6) { top: 70%; left: 75%; animation-delay: 1.5s; }
      .star:nth-child(7) { top: 85%; left: 40%; animation-delay: 1.8s; }
      .star:nth-child(8) { top: 15%; left: 50%; animation-delay: 2.1s; }
      .star:nth-child(9) { top: 55%; left: 60%; animation-delay: 2.4s; }
      .star:nth-child(10) { top: 90%; left: 80%; animation-delay: 2.7s; }

      @keyframes twinkle {
        0%, 100% {
          opacity: 0.2;
          transform: scale(1);
        }
        50% {
          opacity: 0.8;
          transform: scale(1.4);
        }
      }

      /* Error Animation */
      .error-animation {
        font-size: 64px;
        text-align: center;
        margin-bottom: 20px;
        animation: pulse 1s ease-in-out infinite;
      }

      @keyframes pulse {
        0%, 100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
      }

      #selected-state-display {
        background: #0d1635;
        border: 1px solid #f3d854;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
        font-family: 'Source Code Pro', monospace;
        text-align: center;
        white-space: pre;
      }

      #claimed-state-display {
        position: relative;
        padding: 40px;
        margin: 30px auto;
        font-family: 'Source Code Pro', monospace;
        text-align: center;
        white-space: pre;
        font-size: 24px;
        line-height: 1.4;
        max-width: 400px;
        user-select: none;
      }

      #claimed-state-display .grid-content {
        display: inline-block;
        transform-style: preserve-3d;
        transition: transform 0.1s ease-out;
      }

      /* Floating animation for ASCII grid only */
      @keyframes float-grid {
        0%, 100% {
          transform: perspective(1000px) translateY(0px);
        }
        50% {
          transform: perspective(1000px) translateY(-8px);
        }
      }

      #claimed-state-display .grid-content.floating {
        animation: float-grid 3s ease-in-out infinite;
      }

      #claimed-state-display .grid {
        color: #f3d854;
        text-shadow: 0 0 5px #f3d854, 0 0 10px #f3d854;
        font-weight: bold;
      }

      /* Success message styling */
      #success-message {
        color: #c0c0c0;
        font-size: 16px;
        margin-top: 30px;
      }

      #success-message strong {
        color: #e8e8e8;
      }

      /* Modal gets interactive area */
      .modal-content {
        perspective: 1000px;
      }
    </style>
  </head>

  <body>
    <!-- Initial Loading Overlay -->
    <div id="initial-loading" class="loading-overlay">
      <div class="loading-orbital">
        <div class="orbital-container">
          <div class="orbit orbit-1">
            <div class="particle"></div>
          </div>
          <div class="orbit orbit-2">
            <div class="particle"></div>
          </div>
          <div class="orbit orbit-3">
            <div class="particle"></div>
          </div>
        </div>
        <p>Generando los 765 estados √∫nicos...</p>
      </div>
    </div>

    <div class="container">
      <div class="text-content">
        <h1>Tres reyes magos, tres regalos.</h1>
        <p>En este d√≠a de reyes quiero regalar un poco de mis gustos a mi familia y amigos.</p>
        <p>Aqu√≠ est√°n todos los estados posibles del juego del gato. Son <bold>765</bold> y voy a regalar uno a cada persona que conozco (y que se deje ;] ).</p>
        <p>Me parece que el juego y este ejercicio son una forma de conectar con personas que ocupan un lugar en mis memorias y en mi vida. Una forma de hacer latir esos enlaces. Esto es una forma de exponerme, de ser vulnerable pero real. Ya saben como los reyes magos.</p>
        <h2>¬øQu√© tan cerca o lejos est√°s en tu viaje?</h2>
        <p>El juego del tic tac toe me recuerda a las personas pues algunas suceden muy temprano en nuestras vidas. Como los primeros turnos. Otras llegan despu√©s, otras regresan, una cruz o dona en la esquina la comparten muchas y grandes posiciones del tablero. Y algunas han concluido; pero aqu√≠ seguimos jugando.</p>
        <p>Explora los tableros y descubre cu√°l es tu estado. Podr√°s escoger entre tres opciones.</p>
        <p><em>Los estados aparecen en gris hasta que son reclamados. Cuando alguien reclama su estado, este se ilumina y cobra vida en el tablero.</em></p>
        <p>¬°Feliz d√≠a de reyes!</p>

        <p id="stats-text" class="stats"></p>
        <button id="claim-button">Descubre tu propio estado</button>
    </div>

      <div id="all-states"></div>
      <div id="individual"></div>

    </div>

    <!-- Modal para reclamar estado -->
    <div id="claim-modal" class="modal">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <!-- Paso 1: Selecci√≥n de estados -->
        <div id="step-selection" class="modal-step active">
          <h2>Los Reyes Magos te ofrecen tres regalos</h2>
          <p>Elige el que m√°s resuene contigo...</p>

          <div id="shuffling" class="loading-orbital">
            <div class="orbital-container">
              <div class="orbit orbit-1">
                <div class="particle"></div>
              </div>
              <div class="orbit orbit-2">
                <div class="particle"></div>
              </div>
              <div class="orbit orbit-3">
                <div class="particle"></div>
              </div>
            </div>
            <p>Los Reyes Magos preparan tus regalos...</p>
          </div>

          <div id="state-options" class="state-options">
            <!-- States will be dynamically added here -->
          </div>
        </div>

        <!-- Paso 2: Formulario de email -->
        <div id="step-email" class="modal-step">
          <h2>Reclama tu estado √∫nico</h2>
         
          <p>Despu√©s de un rato les dar√© una peque√±a actualizaci√≥n. Una sorpresa m√°s.</p>
          <div id="selected-state-display"></div>

          <form id="claim-form">
            <div class="form-group">
              <label for="user-name">Tu nombre</label>
              <input type="text" id="user-name" name="name" placeholder="Nombre (opcional)" />
            </div>
            <div class="form-group">
              <label for="user-email">Tu email *</label>
              <input
                type="email"
                id="user-email"
                name="email"
                placeholder="email@ejemplo.com"
                required
              />
            </div>
            <button type="submit" class="claim-submit">Reclamar mi regalo</button>
          </form>
          <p class="form-note">Los datos garantizan tu estado √∫nico y me ayudan a crear mi libreta personal para estar en contacto.</p>
        </div>

        <!-- Paso 3: √âxito -->
        <div id="step-success" class="modal-step">
          <div class="success-background">
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
          </div>
          <div class="success-content">
            <h2>¬°Tu regalo ha sido reclamado!</h2>
            <div id="claimed-state-display"></div>
            <p id="success-message"></p>
            <button class="modal-done" id="modal-done">Cerrar</button>
          </div>
        </div>

        <!-- Error state -->
        <div id="step-error" class="modal-step">
          <div class="error-animation">X</div>
          <h2>Algo sali√≥ mal</h2>
          <p id="error-message"></p>
          <button class="retry-button" id="retry-button">Intentar de nuevo</button>
        </div>
      </div>
    </div>
    <footer>
          <p>Con ‚ô• Hugo, with the help of ü§ñ.</p>
     </footer>
    <script type="module" src="/src/main_ascii.js"></script>
  </body>
</html>
